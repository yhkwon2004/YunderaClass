# ============================================================================
# ì‹¤ìŠµ 2: ConvertX - ë²”ìš© íŒŒì¼ ë³€í™˜ê¸°
# ============================================================================
# ğŸ’¡ ì´ íŒŒì¼ì—ëŠ” 15ê°œì˜ ë¹ˆì¹¸ì´ ìˆìŠµë‹ˆë‹¤
# ğŸ“‹ questions.md íŒŒì¼ì˜ ê°ê´€ì‹ ë¬¸ì œë¥¼ ë³´ê³  ë¹ˆì¹¸ì„ ì±„ìš°ì„¸ìš”!
# ğŸ¯ íŠ¹ë³„ í•™ìŠµ í¬ì¸íŠ¸: Root ê¶Œí•œì´ í•„ìš”í•œ íŠ¹ìˆ˜ ì¼€ì´ìŠ¤!
# ============================================================================

name: __________(1)__________

services:
  convertx:
    # ğŸ” íŒíŠ¸: GitHub Container Registry ì´ë¯¸ì§€, v0.14.1 ë²„ì „
    #          í˜•ì‹: ghcr.io/ì‘ì„±ì/ì´ë¯¸ì§€ì´ë¦„:ë²„ì „
    image: __________(2)__________
    
    container_name: convertx
    restart: unless-stopped
    
    # ğŸ” íŒíŠ¸: âš ï¸ íŠ¹ìˆ˜ ì¼€ì´ìŠ¤!
    #          ConvertXëŠ” SQLite ë°ì´í„°ë² ì´ìŠ¤ ê¶Œí•œ ë¬¸ì œë¡œ root í•„ìš”
    #          ì¼ë°˜ì ìœ¼ë¡œëŠ” $PUID:$PGIDë¥¼ ì‚¬ìš©í•˜ì§€ë§Œ, ì´ ì•±ì€ ì˜ˆì™¸!
    #          rationale.md íŒŒì¼ì— ì´ìœ ë¥¼ ì„¤ëª…í•´ì•¼ í•¨
    user: "__________(3)__________"
    
    deploy:
      resources:
        limits:
          # ğŸ” íŒíŠ¸: íŒŒì¼ ë³€í™˜ì€ ë©”ëª¨ë¦¬ë¥¼ ë§ì´ ì‚¬ìš©
          #          G ë‹¨ìœ„ë¡œ ì§€ì • (ì˜ˆ: 2G)
          memory: __________(4)__________
          cpus: '1.0'
    
    # ğŸ” íŒíŠ¸: ì›¹ UI í¬íŠ¸ëŠ” 3000
    ____(5)____:
      - __________(6)__________
    
    environment:
      # ğŸ” íŒíŠ¸: Rootë¡œ ì‹¤í–‰í•˜ë¯€ë¡œ PUID/PGIDë„ 0ìœ¼ë¡œ ì„¤ì •
      - PUID=__________(7)__________
      - PGID=__________(8)__________
      - JWT_SECRET=$default_pwd
      - ACCOUNT_REGISTRATION=false
      - HTTP_ALLOWED=true
      - ALLOW_UNAUTHENTICATED=false
      - AUTO_DELETE_EVERY_N_HOURS=24
    
    volumes:
      # ğŸ” íŒíŠ¸: SQLite ë°ì´í„°ë² ì´ìŠ¤ê°€ ì €ì¥ë  ìœ„ì¹˜
      - /DATA/AppData/$AppID/data:/app/data
      
      # ğŸ” íŒíŠ¸: ë³€í™˜í•  íŒŒì¼ì„ ì½ì–´ì˜¬ ìœ„ì¹˜ (ì½ê¸° ì „ìš©)
      #          :roë¥¼ ë¶™ì—¬ì„œ ì½ê¸° ì „ìš©ìœ¼ë¡œ ë§ˆìš´íŠ¸
      - /DATA/Downloads:/downloads:__________(9)__________
      - /DATA/Documents:/documents:__________(10)__________
    
    healthcheck:
      test: ["CMD", "wget", "--spider", "--tries=1", "http://localhost:3000/"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s

x-casaos:
  architectures:
    - amd64
    - arm64
  
  main: convertx
  
  # ğŸ” íŒíŠ¸: ì„¤ì¹˜ ì „ì— ë°ì´í„° ë””ë ‰í† ë¦¬ë¥¼ ìƒì„±í•˜ê³  ê¶Œí•œ ì„¤ì •
  #          chmod 777ì€ ëª¨ë“  ì‚¬ìš©ìì—ê²Œ ì½ê¸°/ì“°ê¸°/ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬
  pre-install-cmd: |
    mkdir -p /DATA/AppData/$AppID/data &&
    chmod -R 777 /DATA/AppData/$AppID/data &&
    echo "ConvertX data directory prepared with full permissions"
  
  author: CasaOS Team
  
  # ğŸ” íŒíŠ¸: ìœ í‹¸ë¦¬í‹° ë„êµ¬
  category: __________(11)__________
  
  developer: C4illin
  
  icon: https://cdn.jsdelivr.net/gh/Yundera/AppStore@main/Apps/ConvertX/icon.png
  screenshot_link:
    - https://cdn.jsdelivr.net/gh/Yundera/AppStore@main/Apps/ConvertX/screenshot-1.png
    - https://cdn.jsdelivr.net/gh/Yundera/AppStore@main/Apps/ConvertX/screenshot-2.png
    - https://cdn.jsdelivr.net/gh/Yundera/AppStore@main/Apps/ConvertX/screenshot-3.png
  thumbnail: https://cdn.jsdelivr.net/gh/Yundera/AppStore@main/Apps/ConvertX/thumbnail.png
  
  title:
    en_us: ConvertX
  
  tagline:
    en_us: Universal file converter supporting 1000+ formats
    ko_kr: 1000ê°œ ì´ìƒì˜ í˜•ì‹ì„ ì§€ì›í•˜ëŠ” ë²”ìš© íŒŒì¼ ë³€í™˜ê¸°
    zh_cn: æ”¯æŒ1000å¤šç§æ ¼å¼çš„é€šç”¨æ–‡ä»¶è½¬æ¢å™¨
    fr_fr: Convertisseur de fichiers universel supportant plus de 1000 formats
    es_es: Convertidor de archivos universal que admite mÃ¡s de 1000 formatos
  
  description:
    en_us: ConvertX is a self-hosted universal file converter that supports over 1000 different file formats. Convert images, videos, audio files, documents, 3D models, and more directly from your browser. All processing happens locally on your server, ensuring complete privacy and security. Built with TypeScript and powered by FFmpeg, Pandoc, ImageMagick, and other proven libraries for reliable file conversion.
    ko_kr: ConvertXëŠ” 1000ê°œ ì´ìƒì˜ ë‹¤ì–‘í•œ íŒŒì¼ í˜•ì‹ì„ ì§€ì›í•˜ëŠ” ìê°€ í˜¸ìŠ¤íŒ… ë²”ìš© íŒŒì¼ ë³€í™˜ê¸°ì…ë‹ˆë‹¤. ë¸Œë¼ìš°ì €ì—ì„œ ì§ì ‘ ì´ë¯¸ì§€, ë¹„ë””ì˜¤, ì˜¤ë””ì˜¤ íŒŒì¼, ë¬¸ì„œ, 3D ëª¨ë¸ ë“±ì„ ë³€í™˜í•˜ì„¸ìš”. ëª¨ë“  ì²˜ë¦¬ëŠ” ì„œë²„ì—ì„œ ë¡œì»¬ë¡œ ì´ë£¨ì–´ì ¸ ì™„ì „í•œ ê°œì¸ì •ë³´ ë³´í˜¸ì™€ ë³´ì•ˆì„ ë³´ì¥í•©ë‹ˆë‹¤. TypeScriptë¡œ êµ¬ì¶•ë˜ì—ˆìœ¼ë©° FFmpeg, Pandoc, ImageMagick ë“± ê²€ì¦ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ êµ¬ë™ë˜ì–´ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” íŒŒì¼ ë³€í™˜ì„ ì œê³µí•©ë‹ˆë‹¤.
    zh_cn: ConvertXæ˜¯ä¸€ä¸ªæ”¯æŒ1000å¤šç§ä¸åŒæ–‡ä»¶æ ¼å¼çš„è‡ªæ‰˜ç®¡é€šç”¨æ–‡ä»¶è½¬æ¢å™¨ã€‚ç›´æ¥ä»æµè§ˆå™¨è½¬æ¢å›¾åƒã€è§†é¢‘ã€éŸ³é¢‘æ–‡ä»¶ã€æ–‡æ¡£ã€3Dæ¨¡å‹ç­‰ã€‚æ‰€æœ‰å¤„ç†éƒ½åœ¨æ‚¨çš„æœåŠ¡å™¨ä¸Šæœ¬åœ°è¿›è¡Œ,ç¡®ä¿å®Œå…¨çš„éšç§å’Œå®‰å…¨ã€‚ä½¿ç”¨TypeScriptæ„å»º,å¹¶ç”±FFmpegã€Pandocã€ImageMagickç­‰ç»è¿‡éªŒè¯çš„åº“æä¾›æ”¯æŒ,å®ç°å¯é çš„æ–‡ä»¶è½¬æ¢ã€‚
    fr_fr: ConvertX est un convertisseur de fichiers universel auto-hÃ©bergÃ© qui prend en charge plus de 1000 formats de fichiers diffÃ©rents. Convertissez images, vidÃ©os, fichiers audio, documents, modÃ¨les 3D et plus directement depuis votre navigateur. Tout le traitement se fait localement sur votre serveur, garantissant une confidentialitÃ© et une sÃ©curitÃ© complÃ¨tes. Construit avec TypeScript et alimentÃ© par FFmpeg, Pandoc, ImageMagick et d'autres bibliothÃ¨ques Ã©prouvÃ©es pour une conversion de fichiers fiable.
    es_es: ConvertX es un convertidor de archivos universal auto-hospedado que admite mÃ¡s de 1000 formatos de archivo diferentes. Convierte imÃ¡genes, videos, archivos de audio, documentos, modelos 3D y mÃ¡s directamente desde tu navegador. Todo el procesamiento ocurre localmente en tu servidor, garantizando privacidad y seguridad completas. Construido con TypeScript y potenciado por FFmpeg, Pandoc, ImageMagick y otras bibliotecas probadas para una conversiÃ³n de archivos confiable.
  
  tips:
    before_install:
      en_us: |
        **Important Setup Instructions**
        
        - **First User is Admin**: The first registered account becomes administrator
        - **HTTP_ALLOWED**: Set to true for NSL router compatibility
        - **Auto Cleanup**: Files auto-delete after 24 hours (configurable)
        - **Root User**: Running as root (0:0) due to SQLite permission requirements (see rationale.md)
        
        **Supported Formats**
        - Images: PNG, JPG, WebP, AVIF, SVG, GIF, TIFF, BMP via ImageMagick
        - Videos: MP4, WebM, AVI, MOV, MKV via FFmpeg
        - Audio: MP3, WAV, FLAC, OGG, AAC, M4A
        - Documents: PDF, DOCX, HTML, Markdown via Pandoc
        - 3D Models: STL, OBJ, PLY, DAE
        - Archives: ZIP, RAR, 7Z, TAR
        
        Access via: `https://convertx-[username].nsl.sh`
        
        **Note**: This app requires root permissions to function properly with SQLite database.
  
  index: /
  
  # ğŸ” íŒíŠ¸: exposeí•œ í¬íŠ¸ì™€ ì¼ì¹˜
  webui_port: __________(12)__________
  
  # ğŸ” íŒíŠ¸: nameê³¼ ë™ì¼
  store_app_id: __________(13)__________
  
  is_uncontrolled: __________(14)__________

# ============================================================================
# ğŸ“ rationale.md íŒŒì¼ ë‚´ìš© (ì°¸ê³ ìš©)
# ============================================================================
# # ConvertX Root Permissions Rationale
# 
# ## Why Root Access is Required
# 
# ConvertX requires root (0:0) permissions due to SQLite database file access
# requirements. The application creates and manages a SQLite database that
# requires specific ownership and permissions.
# 
# ## Security Considerations
# 
# - **Isolated Storage**: All data is contained within /DATA/AppData/convertx/
# - **No User Directory Access**: Does not access /DATA/Documents, /DATA/Downloads
#   except for read-only operations
# - **Local Processing**: All file conversions happen locally, no external uploads
# - **Access Control**: JWT authentication prevents unauthorized access
# - **Account Registration**: Disabled by default (ACCOUNT_REGISTRATION=false)
# 
# ## Mitigation Measures
# 
# 1. **Volume Isolation**: Only mounts necessary directories
# 2. **Read-Only Mounts**: User directories mounted as read-only (:ro)
# 3. **Resource Limits**: Memory and CPU limits prevent resource exhaustion
# 4. **Auto Cleanup**: Files automatically deleted after 24 hours
# 5. **Authentication Required**: ALLOW_UNAUTHENTICATED=false enforces login
# 
# ## Alternative Approaches Considered
# 
# We attempted running with PUID:PGID but encountered:
# - SQLite database permission errors
# - File lock conflicts
# - Inconsistent behavior across updates
# 
# The official ConvertX documentation recommends root access for production
# deployments when using SQLite.
# ============================================================================

# ============================================================================
# âœ… ì™„ì„± í›„ í™•ì¸ì‚¬í•­
# ============================================================================
# 1. userê°€ "0:0"ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆë‚˜ìš”? (root í•„ìš”!)
# 2. PUIDì™€ PGIDë„ 0ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆë‚˜ìš”?
# 3. ì½ê¸° ì „ìš© ë³¼ë¥¨ì— :roê°€ ë¶™ì–´ ìˆë‚˜ìš”?
# 4. expose í¬íŠ¸ì™€ webui_portê°€ ì¼ì¹˜í•˜ë‚˜ìš”?
# 5. ë©”ëª¨ë¦¬ ì œí•œì´ ì ì ˆí•œê°€ìš”? (íŒŒì¼ ë³€í™˜ì€ ë©”ëª¨ë¦¬ë¥¼ ë§ì´ ì‚¬ìš©!)
# ============================================================================

# ğŸ“ í•™ìŠµ í¬ì¸íŠ¸
# - ëŒ€ë¶€ë¶„ì˜ ì•±ì€ $PUID:$PGIDë¥¼ ì‚¬ìš©í•˜ì§€ë§Œ
# - íŠ¹ë³„í•œ ê²½ìš° root ê¶Œí•œì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
# - ì´ ê²½ìš° rationale.mdì— ì´ìœ ë¥¼ ë¬¸ì„œí™”í•´ì•¼ í•©ë‹ˆë‹¤!
